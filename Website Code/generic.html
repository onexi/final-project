<!DOCTYPE html>
<!--
	Interphase by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>GoldenLyrics - Predictions</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
        
        

		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
	</head>
	<body>

		<!-- Header -->
			<header id="header">
				
				<nav id="nav">
					<ul>
						<li><a href="index.html">Data Visualizations</a></li>
						<li><a href="generic.html">Predictions</a></li>
						<li><a href="elements.html">Credits</a></li>
					</ul>
				</nav>
			</header>

		<!-- Main -->
			<section id="main" class="wrapper">
				<div class="container">

					<header class="major">
						<h2>Predictions</h2>
						<p>Input your own lyrics to predict the popularity and decade ressemblance of your song!</p>
					</header>

					<a href="#" class="image fit"><img src="images/Concert2.jpg" alt="" /></a>
					<p>The Billboard Top 100 songs in the US of the past 50 years have been analyzed with different criteria in the data visualizations section. In total, 12 parameters have been identified and can bes used to quantify the lyrics of the song (forming an array containing 12 numbers from 0 to 1 for every song). Each number characterizes the "strength" of a song lyric for each parameter. This can be used to classify the songs per decade of release (1960s, 1970s, ..., 2010s) and rank (0-10, 10-20, ..., 90-100) at the year of release using kNN means.</p>
					<p>The following box allows you to input your own lyrics and obtain 2 predictions. An algorithm will treat your text and return either the decade during which your song would have been most popular, or the rank at which your song could peak in 2017.</p>
					<p>The classification and prediction process is fairly accurate as of now. Both predictions are successful around 30% of the time, so further improvements could be made. However, this project is based on the hypothesis that song lyrics are at the core of making a song popular, which is of course not the case. Other factors such as the artist's name, chord progression or features, are all important in creating a popular song. Also, the parameters of study have been chosen randomly and might not be the best to characterize a song's lyric as fully as possible. This could also explain the relatively low success rate of the predictions.</p>

				</div>
			</section>

            <section id="main" class="wrapper">
				<div class="container">

                        <section>
							
							<form>
                                <h3>Prediction Choice</h3>
									<input type="radio" name="predictChoice" value="decade" id = "dec"> Decade<br>
                                    <input type="radio" name="predictChoice" value="popularity" id = "pop"> Popularity<br>

                                <h3>Lyric input</h3><br>
									<div id = "textlyrics">
										<textarea type = "text" name="message" id="inputlyrics" placeholder="Enter your own lyrics here (at least 10 words)" rows="10"></textarea><br>
                                        
									</div>
                                    
									<div class="12u$">
										<ul class="actions">
											<input type="submit" onclick="inputText()" value="Predict"/>
                                            
											
										</ul>
									</div>
								
							</form>
                            <script>
                                function inputText(){
                                    var input0 = document.getElementById('inputlyrics').value;
                                    
            var convertToArray = function(element){
                return element.split(' ');
            };
            
            var input = convertToArray(input0);
            var point = [0,0,0,0,0,0,0,0,0,0,0,0];
            //1
            point[0] = input.length/1180;
            //2
            var uniquewords = [];
            for (var i = 0; i < input.length; i++){
                if (uniquewords.includes(input[i]) === false){
                    uniquewords.push(input[i]);
                }
            }
            point[1] = uniquewords.length/440;
            //3
            var vulgarWords = ['nigger','nigga','niggas','fuck','shit','dick', 'bitch', 'cock', 'damn', 'ass', 'cunt', 'whore', 'pussy', 'slut', 'fucking', 'piss', 'pissed', 'bullshit'];
            var count = 0;
            for (var j = 0; j < input.length; j++){
                if (vulgarWords.includes(input[j])){
                    count = count + 1;
                }
            }
            point[2] = count/76;
            //4
            var themes = 
                [{theme: 'music', wordbank: ['music', 'song', 'sing', 'rap', 'rock', 'jazz', 'disco']},
            {theme: 'lifestyle', wordbank: ['money', 'car', 'friend', 'spend', 'fly', 'travel', 'beer', 'limousine']},
            {theme: 'party', wordbank: [ 'dance', 'night', 'friends', 'dj', 'party', 'tonights', 'girls', 'drink', 'drinking', 'dancing','club', 'bass']},
            {theme: 'love', wordbank: ['woman','love', 'girl', 'heart', 'kiss', 'sex', 'sexy', 'face', 'lovin', 'baby', 'sweet']},
            {theme: 'religion', wordbank: ['god', 'pray', 'religion', 'lord']},
            {theme: 'death', wordbank: ['death', 'die', 'dead', 'war', 'kill', 'murder', 'bullet', 'gun', 'shoot', 'shot']},
            {theme: 'politics', wordbank: ['politics', 'politician', 'politicians', 'social', 'injustice', 'government', 'congressman', 'terrorism', 'terrorists', 'law', 'laws', 'trial', 'trials']}
                ];
            //4
            var countm = 0;
            for (var im= 0; im < input.length; im++){
                if (themes[0].wordbank.includes(input[im])){
                    countm = countm + 1;
                }
            }
            point[3] = countm/20;
            //5
            var countli = 0;
            for (var il= 0; il < input.length; il++){
                if (themes[1].wordbank.includes(input[il])){
                    countli = countli + 1;
                }
            }
            point[4] = countli/20;
            //6
            var countp = 0;
            for (var ip= 0; ip < input.length; ip++){
                if (themes[2].wordbank.includes(input[ip])){
                    countp = countp + 1;
                }
            }
            point[5] = countp/20;
            //7
            var countlo = 0;
            for (var ilo= 0; ilo < input.length; ilo++){
                if (themes[3].wordbank.includes(input[ilo])){
                    countlo = countlo + 1;
                }
            }
            point[6] = countlo/20;
            //8
            var countr = 0;
            for (var ir= 0; ir < input.length; ir++){
                if (themes[4].wordbank.includes(input[ir])){
                    countr = countr + 1;
                }
            }
            point[7] = countr/20;
            //9
            var countd = 0;
            for (var id= 0; id < input.length; id++){
                if (themes[5].wordbank.includes(input[id])){
                    countd = countd + 1;
                }
            }
            point[8] = countd/20;
            
            //10
            var frequent = ['little','away','more','think','ive','as','thats','he','heart','here','been','good','life','there','could','about','give','were','from','tell','not','aint','night','will','feel','at','need','are','back','right','her','how','they','ill','have','take','way','was','gonna','cause','never','say','wanna','girl','come','let','she','time','see','cant','out','one','make','down','go','want','yeah','if','now','youre','this','when','what','can','get','got','no','but','up','its','baby','with','do','just','oh','we','is','for','so','like','know','dont','all','of','be','im','love','your','on','that','in','my','it','a','me','and','to','the','i','you'];
            var countf = 0;
            for (var ifr = 0; ifr < frequent.length; ifr++){
                if (input.includes(frequent[ifr])){
                    countf = countf + 1;
                }
            }
            point[9] = countf/100;

            //11
            //var ml = require('ml-sentiment')();
            //point[10] = ml.classify(input)/100;

            //12
            var countRepetedWords = function(input){
                var wordCounts = {};
                var repetedWords = [];
                for (var k = 0; k < input.length; k++){
                    if (input[k].length > 4){
                        wordCounts[input[k]] = (wordCounts[input[k]] || 0) + 1;
                    }
                }
                for (var words in wordCounts){
                    if (wordCounts[words] > 3){
                        repetedWords.push(words);
                    }
                }
                return repetedWords.length;
            };
            point[11] = countRepetedWords(input)/10;
            
            // The chosen prediction dictates which classification the code will do.
            var Calculatedistance = function(obj1, obj2){
                var a1 = obj1;
                var a2 = obj2;
                var count = 0;
                for (var i = 0; i < 12; i++){
                    count += (a1[i]-a2[i])*(a1[i]-a2[i]);
                }
                return Math.sqrt(count);
            }

            if (document.getElementById('dec').checked){
                var centroidsDec = [{"decade":"1960","center":[0.15391016949152547,0.16676363636363623,0,0.018099999999999995,0.011299999999999996,0.032599999999999976,0.29350000000000004,0.008999999999999998,0.010499999999999997,0.30963999999999986,0.12081999999999997,0.3500000000000004]},{"decade":"1970","center":[0.1802881355932203,0.17981363636363618,0.0003026315789473684,0.04120000000000009,0.020850000000000018,0.06675000000000016,0.29629999999999934,0.012949999999999991,0.010899999999999991,0.32323000000000024,0.15165000000000012,0.4236000000000004]},{"decade":"1980","center":[0.21978559322033925,0.20799545454545462,0.00021052631578947361,0.02710000000000002,0.018950000000000005,0.08709999999999975,0.33689999999999864,0.0037500000000000007,0.01174999999999999,0.3812400000000005,0.14041000000000012,0.5817999999999991]},{"decade":"1990","center":[0.2923533898305086,0.26728636363636343,0.010092105263157907,0.02760000000000004,0.03205000000000003,0.0809999999999999,0.4155999999999982,0.013649999999999985,0.01704999999999999,0.43534000000000106,0.13865,0.7642999999999994]},{"decade":"2000","center":[0.3828262711864406,0.32962727272727277,0.03402631578947373,0.05130000000000014,0.05605000000000017,0.1284999999999997,0.40909999999999774,0.013299999999999989,0.020450000000000017,0.49753000000000003,0.08585999999999999,1.028599999999998]},{"decade":"2010","center":[0.3435918079096045,0.29783712121212114,0.03348684210526316,0.0488333333333333,0.05691666666666668,0.14075000000000004,0.4036666666666655,0.010000000000000004,0.03191666666666666,0.47169999999999923,0.05716666666666674,0.9196666666666652]}];

                var distances = [];
                for (var i = 0; i < 6; i++){                    
                    var obj = {};
                    obj.decade = centroidsDec[i].decade;
                    obj.distance = Calculatedistance(point, centroidsDec[i].center);
                    distances.push(obj);
                }
                var prediction = distances.sort(function(a,b){
                    return a.distance -b.distance;
                });
                var final = prediction.slice(0,1);
                alert('The lyrics ressemble a ' + final[0].decade + 's song!');
            }
            else if (document.getElementById('pop').checked){

                var centroidsPop = [{"rank":10,"centroid":[0.11602259887005667,0.10439393939393932,0.003421052631578953,0.018333333333333333,0.03866666666666666,0.05000000000000002,0.04166666666666652,0.0013333333333333335,0.007666666666666669,0.1709999999999997,0.026599999999999985,0.28666666666666685]},{"rank":20,"centroid":[0.02786440677966112,0.0423484848484848,-0.00298245614035088,-0.03900000000000002,-0.011333333333333327,0.0679999999999999,-0.16466666666666674,0.002666666666666666,0.007333333333333324,0.07353333333333356,-0.1312666666666667,0.20066666666666655]},{"rank":30,"centroid":[0.02525423728813575,0.0298181818181818,-0.001754385964912307,-0.025000000000000022,0.016666666666666677,-0.11533333333333334,-0.08466666666666667,-0.008666666666666663,-0.0013333333333333322,0.09533333333333316,-0.05939999999999998,-0.03466666666666662]},{"rank":40,"centroid":[0.06535593220338992,0.062121212121212244,0.032543859649122805,-0.013333333333333329,-0.00233333333333334,-0.00033333333333335213,0.08133333333333326,-0.00033333333333333305,0.014000000000000005,0.09253333333333347,-0.1512,0.20533333333333315]},{"rank":50,"centroid":[0.14742372881355953,0.09836363636363626,0.012017543859649121,0.022999999999999996,0.018666666666666665,0.033666666666666706,0.19233333333333336,0.014000000000000005,0.00966666666666667,0.15006666666666657,0.05133333333333334,0.39333333333333353]},{"rank":60,"centroid":[0.07511299435028274,0.07563636363636372,0.005263157894736845,0.035999999999999976,-0.026333333333333375,0.035,0.07933333333333331,0.012666666666666665,0.05166666666666667,0.1070000000000001,0.0742666666666667,0.13066666666666693]},{"rank":70,"centroid":[0.12009039548022599,0.08124242424242417,-0.0016666666666666635,0.024333333333333346,0.06566666666666668,0.01933333333333337,0.11733333333333351,0.010333333333333335,0.016,0.13340000000000007,-0.021866666666666673,0.4619999999999995]},{"rank":80,"centroid":[0.06968926553672306,0.0755909090909091,0.007807017543859648,-0.08466666666666664,-0.016333333333333297,0.052666666666666695,0.2236666666666667,0.006000000000000002,0.015666666666666662,0.13886666666666658,0.0018666666666666276,0.1726666666666663]},{"rank":90,"centroid":[0.11949152542372887,0.09753030303030308,0.043771929824561386,0.028666666666666677,-0.011333333333333348,0.0063333333333332464,0.08200000000000007,0.004,0.014666666666666668,0.1252000000000001,-0.08580000000000003,0.2426666666666667]},{"rank":100,"centroid":[0.11346892655367241,0.11259090909090913,0.05122807017543861,0.014000000000000005,-0.0013333333333332975,0.05100000000000001,0.13800000000000007,0.0036666666666666584,-0.0030000000000000096,0.12933333333333358,-0.00973333333333333,0.3426666666666669]}];

                var distances = [];
                for (var i = 0; i < 10; i++){                    
                    var obj = {};
                    obj.rank = centroidsPop[i].rank;
                    obj.distance = Calculatedistance(point, centroidsPop[i].centroid);
                    distances.push(obj);
                }
                var prediction = distances.sort(function(a,b){
                    return a.distance -b.distance;
                });
                var final = prediction.slice(0,1);
                alert('Your song could be a Top ' + final[0].rank + ' hit in 2017!');

            }
            else{
                alert('Please choose a prediction.');
            }


















                                }


                                

            

            

            



                            </script>
						</section>
            </div>
			
            
            </section>
		<!-- Footer -->
			<footer id="footer">
				<div class="container">
				
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li>
						<li>Design: <a href="http://templated.co">TEMPLATED</a></li>
						
					</ul>
				</div>
			</footer>

	</body>
</html>